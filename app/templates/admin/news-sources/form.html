{% extends "admin/base.html" %}

{% set page_title = "Edit News Source" if source else "New News Source" %}
{% set active_nav = "news-sources" %}

{% block admin_content %}
<header class="admin-main__header">
  <h1 class="admin-main__title">{{ "Edit News Source" if source else "New News Source" }}</h1>
  <p class="admin-main__subtitle">
    {% if source %}
    Modify the settings for {{ source.name }}
    {% else %}
    Add a new RSS feed or other news source
    {% endif %}
  </p>
</header>

<div class="admin-card" style="max-width: 600px;">
  <form
    class="admin-form"
    method="post"
    action="{% if source %}/admin/news-sources/{{ source.id }}{% else %}/admin/news-sources{% endif %}"
  >
    <div class="admin-form__field">
      <label class="admin-form__label" for="name">Name</label>
      <input
        class="admin-form__input"
        id="name"
        name="name"
        type="text"
        value="{{ source.name if source else '' }}"
        required
      />
      <span class="admin-form__help">Internal identifier (e.g., "floor-and-ceiling")</span>
    </div>

    <div class="admin-form__field">
      <label class="admin-form__label" for="display_name">Display Name</label>
      <input
        class="admin-form__input"
        id="display_name"
        name="display_name"
        type="text"
        value="{{ source.display_name if source else '' }}"
        required
      />
      <span class="admin-form__help">Name shown to users (e.g., "Floor and Ceiling")</span>
    </div>

    <div class="admin-form__field">
      <label class="admin-form__label" for="feed_type">Feed Type</label>
      <select class="admin-form__select" id="feed_type" name="feed_type" required>
        {% for ft in feed_types %}
        <option value="{{ ft.value }}" {% if source and source.feed_type == ft %}selected{% endif %}>
          {{ ft.value | upper }}
        </option>
        {% endfor %}
      </select>
    </div>

    <div class="admin-form__field">
      <label class="admin-form__label" for="feed_url">Feed URL</label>
      <input
        class="admin-form__input"
        id="feed_url"
        name="feed_url"
        type="url"
        value="{{ source.feed_url if source else '' }}"
        placeholder="https://example.com/feed.rss"
        required
      />
      <span class="admin-form__help">The URL to fetch the feed from</span>
    </div>

    <div class="admin-form__field">
      <label class="admin-form__label" for="fetch_interval_minutes">Fetch Interval (minutes)</label>
      <input
        class="admin-form__input"
        id="fetch_interval_minutes"
        name="fetch_interval_minutes"
        type="number"
        min="5"
        max="1440"
        value="{{ source.fetch_interval_minutes if source else 30 }}"
        required
      />
      <span class="admin-form__help">How often to check for new content (5-1440 minutes)</span>
    </div>

    <div class="admin-form__checkbox-field">
      <input
        class="admin-form__checkbox"
        id="is_active"
        name="is_active"
        type="checkbox"
        value="1"
        {% if not source or source.is_active %}checked{% endif %}
      />
      <label class="admin-form__checkbox-label" for="is_active">Active</label>
    </div>

    <div class="admin-form__actions">
      <button type="submit" class="admin-btn admin-btn--primary">
        {{ "Save Changes" if source else "Create Source" }}
      </button>
      <a href="/admin/news-sources" class="admin-btn admin-btn--secondary">Cancel</a>
    </div>
  </form>
</div>
{% endblock %}
